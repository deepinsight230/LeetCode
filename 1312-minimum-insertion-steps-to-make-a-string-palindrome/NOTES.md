Why memoization fails n<=500, so n^2 should work?